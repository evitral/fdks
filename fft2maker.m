
hx = hn;

hnf = fft2(hx);
emf = hnf.*conj(hnf);
%emf2 = emf([33:64 1:32],[33:64 1:32]);
%emf2 = emf([129:256 1:128],[129:256 1:128]);
emf2 = emf([257:512 1:256],[257:512 1:256]);

hx = emf2.^0.125;
%hy = hx(64:192,64:192);
hy = hx(128:384,128:384);

% surf(emf2.^0.5)